[.text-justify]
= Задания, v{revnumber}
:source-highlighter: coderay
:toc:
:toclevels: 3
:sectnums:
:pagenums:
:last-update-label!:
:toc-title: Содержание
:sect-caption: Разд.
:section-refsig: Разд.
:table-caption: Табл.
:figure-caption: Рис.
:chapter-signifier:
:chapter-refsig: Разд.
:part-signifier:
:part-refsig: Часть
:xrefstyle: full
:stem:
:pdf-page-layout: portrait
:doctype: article
:author: Кулешов М.В.
:email: kuleshov_mv@lemz-t.ru
:version-label: Версия
:revdate: {docdate}
:revnumber: 1.0
:revremark: Добавляю первое "домашнее задание".

== Введение

Сегодня согласовали новую методику работы:

* все лабораторные для платы ZC702 выполняются в одном проекте Vivado,
* этот проект и ответы на проверочные вопросы каждый студент выкладывает в свой персональный репозиторий в github.

== Vivado

Столкнулись с рядом проблем, что нужно обязательно сделать.

=== Установить драйвер для USB-кабеля

[source,bash,linenums]
----
sudo {путь_до_установочной_директории_Vivado}/data/xicom/
cable_drivers/lin64/install_script/install_drivers/install_drivers

----

=== Настроить GUI Vivado

Нужно включить отображение всех сигналов в симуляторе, отключить перестройку иерархии в синтезе и заменить линтер Sigasi на Vivado в настройках текстового редактора.

[cols="2",frame=none,grid=none]
|===
a|
image::../Images/vivado_sim.png[title=Настройки симулятора]
a|
image::../Images/vivado_synth.png[title=Настройки синтеза]
2+a|
image::../Images/vivado_linter.png[title=Настройки линтера,width=50%,align="center"]
|===

== Visual Studio Code

Для удобства работы предлагаю альтернативу встроенному текстовому редактору Vivado -- VSCode (или альтернативы).

Что для этого нужно:

* установить следующее расширение в VSCode

----
Name: Verilog-HDL/SystemVerilog/Bluespec SystemVerilog
Id: mshr-h.veriloghdl
Description: Verilog-HDL/SystemVerilog/Bluespec SystemVerilog support for VS Code
Version: 1.13.5
Publisher: Masahiro Hiramori
VS Marketplace Link: https://marketplace.visualstudio.com/items?itemName=mshr-h.VerilogHDL
----

* установить верилятор

----
sudo apt-get install verilator
----

* выбрать верилятор в настройках расширения

image::../Images/vscode_verilator.png[title=Настройки VSCode,width=50%,align="center"]

Отпишитесь, получилось или нет -- у меня подчёркивает ошибки после сохранения документа.
Есть и более продвинутые варианты для работы с проектами,
но этот -- самый простой для первого знакомства и использования в качестве "блокнота" фактически.

== GitHub

В целом, следуйте инструкциям на сайте.
И нужно установить `git`, если его нет.
Чуть более подробно:

* создайте учётную запись;
* создайте, добавьте в менеджер ключей и на сайт github ssh-ключ +
(https://docs.github.com/ru/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent);
* не совсем понял, обязательно ли сейчас создавать токен, но на всякий случай создал +
(https://docs.github.com/ru/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens);
* также для удобства работы можете установить `gh` и залогиниться там +
(https://docs.github.com/en/enterprise-cloud@latest/github-cli/github-cli/quickstart);
* устанавливайте GitHub Desktop +
(https://github.com/shiftkey/desktop)
* создайте пустой публичный проект, клонируйте его к себе на диск через GHDesktop;
* копируйте туда свой Vivado проект, сохраняйте изменения и пушьте их на сервер. 

Пример моего проекта: https://github.com/subject-name-here-00/hdl-test.

== Лабораторная работа №1

[%header,cols="^1,^2",width=75%,align="center"]
.Индивидуальные задания
|===
^|Студенты ^|Задания

|Вадим, Григорий
|Лабораторная работа №1, задание 1 (с.36)

|Владислава, Семён
|Лабораторная работа №2, задание 2 (с.37)
|===

Потренируйтесь использовать `case` или булеву алгебру перед переходом к конечным автоматам.
Можете реализовать мультиплексор через неблокирующие присвоения.
Составьте тестбенч для проверки:

* проверить каждое состояние селектора,
* между переключениями селектора должно пройти несколько периодов самого "медленного" сигнала, чтобы убедиться, что мы видим именно выбранный вход на выходе.

== Лабораторная работа №2

=== Основное задание

Я ориентируюсь на документ "Лаб№2_упр_светод.docx".
Создавайте модуль по инструкциям из лабораторной работы.
В качестве платы в проекте указывайте ZC702, все параметры (пины и пр) берите для неё из соответствующей документации.

Чтобы адаптировать лабораторную работу для этой платы придётся внести небольшие изменения.
Я предлагаю добавить внешний топ-модуль ("враппер"), в котором реализовать преобразование дифференциального внешнего клока.
В диалог сегодня скидывал вариант с IBUFDS и BUFG.
Альтернатива -- добавить в проект Clocking Wizard IP.
Все настройки в таком случае можно оставить по умолчанию.

image::../Images/lab2_sch1.png[title=Пример реализации Лаб2 с ФАПЧ]

=== Дополнительные задания и вопросы

Первые 4 вопроса распределим как индивидуальные задания, которые нужно реализовать в коде.
Здесь используйте систему контроля версий:

* сперва выполнили и сохранили основное задание лабораторной работы (с.17, п.2.8);
* потом выполнили и так же сохранили в git индивидуальное задание.

Битстримы (bit-файлы) для каждого этапа можете переименовать и сохранить в отдельной папке.
Каждый раз когда вы запускаете имплементацию -- последний битстрим удаляется (но пока у нас небольшие проекты, так что это нестрашно).

Дополнительное усложнение задания: на плате доступно не 4, а 8 светодиодов в ряд.

* добавьте в топ-модуль вторую копию модуля, отвечающего за мигание светодиодами,
* выходы первого назначены на ножки [3:0], второго -- [7:4],
* на вход первого подаётся ресет с кнопки SW5 (left), а второго -- c SW7 (right).




[%header,cols="^1,^2",width=75%,align="center"]
.Индивидуальные задания
|===
^|Студенты ^|Задания

|Вадим
|Лабораторная работа №2, задание 1.1 (с.19)

|Владислава
|Лабораторная работа №2, задание 1.2 (с.19)

|Григорий
|Лабораторная работа №2, задание 1.3 (с.19)

|Семён
|Лабораторная работа №2, задание 1.4 (с.19)
|===

На прочие вопросы нужно дать ответ в свободной форме, написать небольшой фрагмент кода или приложить снимок.

[%header,cols="1,2",width=75%,align="center"]
.Общие задания
|===
^|Задания ^|Формат ответа
|1.5, 1.6 |ответ
|1.7      |пропуск
|1.8      |ответ
|2.1      |ответ (вкратце)
|2.2      |пропуск
|3.1, 3.2 |обсуждение в офисе
|3.3-3.5  |ответ
|4.1      |обсуждение в офисе
|4.2-4.3  |ответ
|5.1, 5.2 |ответ (вкратце)
|6.1-6.4  |ответ
|===

На "устные" тоже приготовьтесь дать ответ!
